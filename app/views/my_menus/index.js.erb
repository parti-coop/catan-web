var $drawer_issues = $('<%= j(render 'application/drawer_issues') %>');
if($('#js-my-menu-drawer_issues').length > 0) {
  var $drawer_merged = $('<%= j(render 'application/drawer_search') %>');
  $drawer_merged = $drawer_merged.add($drawer_issues);
  $('#js-my-menu-drawer_issues').replaceWith($drawer_merged);
  parti_partial$($drawer_merged, true);
} else {
  $('.js-group-issues-line').remove();
  $('.js-drawer-filter-form').after($drawer_issues);
  parti_partial$($drawer_issues, true);
}

<% if user_signed_in? %>
  var $fixed_top = $('.js-drawer-current-group-fixed-top');
  $fixed_top.parent().removeClass('inactive');
  $fixed_top.attr('href', $fixed_top.data('inactive-url'));

  var $unfold_only = $('.js-drawer-current-group-unfold-only');
  $unfold_only.parent().removeClass('inactive');
  $unfold_only.attr('href', $unfold_only.data('inactive-url'));
<% end %>

$('.js-sidemenu-highlight-menu-parti').removeClass('highlight');
var need_to_group_highlight = true;

$('.js-sidemenu-highlight-current-parti-source').each(function(index) {
  var current_parti_id = $(this).data('sidemenu-highlight-current-parti-id');
  var highlight_menu = $('.js-sidemenu-highlight-menu-parti-' + current_parti_id);

  if(highlight_menu.length > 0) {
    highlight_menu.addClass('highlight');
    highlight_menu.closest('.js-sidemenu-toggle-group').find('.js-sidemenu-toggle').trigger('click', 'unfold');
    need_to_group_highlight = false;
  }
});

<% if current_group.present? %>
  if(need_to_group_highlight) {
    var highlight_menu = $('.js-sidemenu-highlight-menu-group-<%= current_group.id %>');
    highlight_menu.addClass('highlight');
  }
<% end %>
