- paging = (!@posts.nil? and @posts.try(:current_page).present?)

%section.contents-page#posts
  .container
    .row
      = main_column_tag do
        .js-invisible-on-mobile-editing
          = render 'application/my_home_tab'

        - if current_user.need_to_more_member?(current_group)
          .post-editor.post-editor-intro.cursor-default
            .text-muted
              .media
                .media-left
                  = byline current_user, hide_nickname: true
                .media-body
                  #{current_user.nickname}님, 이제 빠띠를 시작해보세요!
                  = link_to '시작하기', dashboard_intro_path, class: 'btn btn-primary'
        - else
          - member_issues = current_user.member_issues.order(:title)
          .post-editor.post-editor-intro.js-post-editor-intro
            .text-muted
              = byline current_user, hide_nickname: true
              .placeholder #{current_user.nickname}님, 무슨 이야기를 나누실래요?

          .post-editor.post-editor--hidden.js-post-editor.js-parti-editor-selector-wrapper
            = render 'posts/post_editor', current_issue: nil

        .js-invisible-on-mobile-editing
          = render 'posts/new_posts_count', new_posts_count_url: new_dashboard_posts_count_path(group_slug: current_dashboard_group.try(:slug), last_time: DateTime.now.to_i)

          .js-my-home-tab-sticky-offset

          .posts{data: {last_id: -1, is_last: 'false'}}
            #no-data.text-center.alert{ style: ('display: none;' if !paging or @posts.any?) }
              %i.fa.fa-info-circle
                게시글이 없습니다.
            - if paging
              = render 'posts/page', posts: @posts, show_issue: true, show_day_section: true, first_today_text: ("게시물 #{number_with_delimiter @posts.total_count}개 중에 #{@posts.current_page}페이지를 표시합니다" unless @posts.first_page?)

          - if paging
            = paginate @posts, theme: 'catan'

            - if @recommend_posts.any?
              %hr

              .post-data-divider 다른 그룹에선 이런 이야기를 나누고 있어요
              = render 'posts/list_card', posts: @recommend_posts.limit(30).to_a.sample(3)


          - else
            .page-waypoint.js-page-waypoint-onload.text-center{ 'data-target': '.posts', 'data-url': dashboard_path(format: :js, group_slug: current_dashboard_group.try(:slug)) }
              .page-waypoint-loading.js-page-waypoint-loading
                %i.fa.fa-2x.fa-spinner.fa-pulse
      - unless is_small_screen?
        = render 'application/aside'
