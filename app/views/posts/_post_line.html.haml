- local_assigns[:mode] ||= 'in-list'
- post = post
- issue = post.issue
.post-line.post-line[post]
  - if local_assigns[:show_issue]
    .post-line__issue.post-line__issue
      = link_to issue_home_path_or_url(issue), target: issue_link_target_name(issue) do
        = image_tag issue.logo.xs.url
        %span.text-primary= issue.title
      %span.post-line__issue__post-type
        &middot;
        #{Post.model_name.human}
  -if post.parsed_title.present?
    %h4.post-line__title.post-line__title
      = post_body_format post.parsed_title
  .post-body
    .post-parsed-body{'data-action': 'parti-link-target-blank'}
      - if %w(modal detail).include? local_assigns[:mode]
        = post_body_format post.parsed_body
      - else
        .truncated-body
          - more_button = capture do
            %button.btn-more.btn-link{ 'data-disable-modal': 'true', 'data-action': 'parti-show-more', 'data-more-wrapper': "##{dom_id(post)}.post-line" } ... 더보기
          = truncate_html(post_body_format(post.parsed_body), length: 500, omission: more_button, word_boundary: false)
        .original-body{ style: 'display: none;' }
          = post_body_format post.parsed_body
    - if post.video_source?
      .post-reference-line.post-line
        .post-reference-line__link-content.post-reference-line__link-content--video
          .post-reference-line__video-container
            .post-reference-line__video-content
              = video_embed_code(post)
          .post-reference-line__site-name
            %a{href: post.reference.url, target: '_blank'}
              = post.site_name.try(:upcase)
              원글보기
              %i.fa.fa-external-link
    - elsif post.file_source?
      - if post.reference.image?
        .post-reference-line__file-content__file-image
          %a{href: post.reference.attachment.url, target: '_blank'}
            = image_tag "#{post.reference.attachment.url}"
      - else
        .post-reference-line.post-line
          .post-reference-line__file-content
            .media
              .media-left.hidden-xs
                %i.fa.fa-floppy-o
              .media-body
                %span.post-line-reference__title
                  = post.reference_title
                %br.visible-xs
                %span.post-reference-line__file-content__file-size
                  = number_to_human_size(post.reference.file_size)
              .media-right
                .post-reference-line__file-content__download
                  %a{href: post.reference_url, target: '_blank'}
                    다운로드
    - elsif post.link_source?
      .post-reference-line.post-line
        %a{href: post.reference_url, target: '_blank'}
          .post-reference-line__link-content
            .media
              .media-body
                %h4.post-line-reference__title= post.reference_title
                .post-reference-line__source-body= excerpt(post.reference_body, length: (is_small_screen? ? 45 : 130))
                .post-reference-line__site-name
                  %a{href: post.reference_url, target: '_blank'}
                    = post.site_name.try(:upcase)
                    원글보기
                    %i.fa.fa-external-link
              - if (post.has_image?)
                .media-right
                  .post-reference-line__link-content__thumb{style: "background-image: url(#{post.image.md.url})"}
    - elsif post.poll.present?
      .poll-card[post.poll]{ class: "#{dom_id(post.poll)} #{user_signed_in? && post.poll.voting_by?(current_user) ? 'poll-card--voted' : ''}"}
        .row.poll-card__meta
          .col-sm-6.col-xs-12
            .poll-card__issue
              = link_to issue_home_path_or_url(issue), target: issue_link_target_name(issue) do
                - unless post.issue.displayable_group? current_group
                  .poll-card__group
                    = post.issue.group.title[0..2]
                .thumb.thumb--issue{ style: "background-image: url(#{issue.logo.sm.url})" }
          .col-sm-6.col-xs-12
            .poll-card__date.date-wrapper.poll-card__date--with-issue
              %span= date_f post.poll.created_at
        %h4.poll-card__title
          “#{post.poll.title}”

        = render 'votings/voting', local_assigns.merge(in_post: true)
    - elsif post.survey.present?
      = render 'surveys/card', local_assigns
