- comment_style = local_assigns[:mode] || 'in-list'
- if post.issue.blank?
  - return
.recent-post-card.post-card{style: "height: 430px;", class: "post-card--#{comment_style} #{dom_id(post)} #{ 'post-card--hidden-issue' unless local_assigns[:show_issue]} #{removable_with_post_dom_class(post) if local_assigns[:mode] == 'list'}", data: { 'parti-comment-style': comment_style }}
  .post-card__content
    .post-card__post
      - if !post.wiki.present?
        = render 'posts/last_stroked_for', post: post

      - local_assigns[:mode] ||= 'in-list'
      - post = post
      - issue = post.issue
      .post-line.post-line[post]
        -if post.parsed_title.present?
          %h4.post-line__title.post-line__title
            = post_body_format post.parsed_title
        .post-body
          - if local_assigns[:post_line]
            - if post.file_sources.only_image.any?
              .post-reference-line-file-content-wrapper--image<>
                - post.file_sources.only_image.sort_by_seq_no.each_with_index do |file_source, index|
                  %a.post-reference-line__file-content--image{ href: file_source.attachment.url, class: 'single' }<>
                    = image_tag file_source.attachment.md.url
          - else
            - if post.file_sources.only_image.any?
              - odd = post.file_sources.only_image.count.odd?
              - image_id = "image-#{SecureRandom.uuid}"
              .post-reference-line-file-content-wrapper--image<>
                - previous_style = nil
                - post.file_sources.only_image.sort_by_seq_no.each_with_index do |file_source, index|
                  - next if index > 1
                  - if is_small_screen?
                    - action_options = { 'data-action': 'parti-link', 'data-url': images_post_path(post), 'data-link-target': '_blank' }
                  - else
                    - action_options = { href: file_source.attachment.lg.url, 'data-lightbox': "image-#{image_id}", 'data-title': post.specific_desc_striped_tags(100) }
                  - if index == 0 and odd == true
                    - current_style = 'single'
                  - elsif previous_style == 'left'
                    - current_style = 'right'
                  - else
                    - current_style = 'left'
                  - if current_style == 'single'
                    %a.post-reference-line__file-content--image{ action_options, class: current_style }<>= image_tag file_source.attachment.md.url, style: 'display: block'
                  - else
                    %a.post-reference-line__file-content--image{ action_options, class: current_style, style: "background-image: url(#{file_source.attachment.md.url});" }<>
                  - previous_style = current_style

            - elsif post.link_source.present?
              .post-reference-line.post-line
                %a{href: post.link_source.url, target: '_blank'}
                  .post-reference-line__link-content
                    - if (post.link_source.has_image?)
                      .post-reference-line__link-content__big-thumb.visible-xs-block{style: "background-image: url(#{post.link_source.image.md.url});", class: ('webp' if is_webp?(post.link_source.image.url))}
                    .media
                      .media-body
                        %h4.post-line-reference__title= post.link_source.title_or_url
                        .post-reference-line__source-body= excerpt(post.link_source.body, length: (is_small_screen? ? 45 : 130))
                        .post-reference-line__site-name
                          %a{href: post.link_source.url, target: '_blank'}
                            = post.link_source.site_name.try(:upcase)
                            원글보기
                            %i.fa.fa-external-link
                      - if (post.link_source.has_image?)
                        .media-right.hidden-xs.post-reference-line__link-content__thumb{style: "background-image: url(#{post.link_source.image.md.url})", 'data-action': 'parti-link', 'data-url': post.link_source.url, 'data-link-target': '_blank', class: ('webp' if is_webp?(post.link_source.image.url)) }
          = link_to post, target: "_blank" do
            .post-parsed-body{'data-action': 'parti-link-target-blank'}
              .truncated-body
                != smart_truncate_html(post.parsed_body, length: 85)

    .post-card__header{ style: "position:absolute; bottom: 0;" }
      .media
        .media-left
          = link_to smart_issue_home_path_or_url(post.issue) do
            .issue-logo{style: "background-image: url(#{post.issue.logo.xs.url});"}
        .media-body
          = link_to smart_issue_home_path_or_url(post.issue) do
            %span.issue-title
              = post.issue.title
              = security_icon(post.issue)


